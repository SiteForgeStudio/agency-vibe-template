---
const { brand, about, intelligence, strategy } = Astro.props;

if (!brand && !about) return null;

/**
 * SAFE DATA EXTRACTION
 */
const brandName = brand?.name || "";
const words = brandName.split(" ");
const firstWord = words[0] || "";
const restOfName = words.slice(1).join(" ");

const story =
  about?.story_text ||
  brand?.tagline ||
  intelligence?.positioning ||
  null;

const founderNote =
  about?.founder_note ||
  brand?.objection_handle ||
  null;

const years =
  about?.years_experience ||
  intelligence?.experience_years ||
  null;

const industry =
  intelligence?.industry ||
  null;

const differentiator =
  intelligence?.core_differentiator ||
  intelligence?.unique_mechanism ||
  null;

/**
 * CARD DETECTION
 */
const cards = {
  story: !!story,
  founder: !!founderNote,
  experience: !!years,
  differentiator: !!differentiator
};

const cardCount =
  Object.values(cards).filter(Boolean).length;

/**
 * AUTO GRID
 */
const gridClass =
  cardCount >= 4
    ? "md:grid-cols-12"
    : cardCount === 3
    ? "md:grid-cols-12"
    : "md:grid-cols-8";
---

<section id="about"
  class="py-24 px-6 bg-[var(--bg-color)] scroll-mt-20">

  <div class="max-w-7xl mx-auto">

    <div class={`grid grid-cols-1 ${gridClass} gap-5 auto-rows-fr`}>

      {cards.story && (
        <div class="md:col-span-8 p-10 rounded-[var(--radius)] bg-[var(--bg-card)] border border-[var(--border)] relative overflow-hidden group">

          <div class="absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity">
            <div class="absolute -top-32 -right-32 w-72 h-72 bg-[var(--accent)] opacity-[0.04] blur-[120px]"></div>
          </div>

          <div class="relative z-10">

            <div class="text-[10px] font-bold tracking-[0.35em] text-[var(--accent)] uppercase mb-4">
              About
            </div>

            <h2 class="text-4xl md:text-6xl font-black tracking-tight leading-[0.95] mb-6">

              {firstWord}

              {restOfName && (
                <span class="block text-[var(--accent)]">
                  {restOfName}
                </span>
              )}

            </h2>

            <p class="text-[var(--text-secondary)] text-base md:text-lg leading-relaxed max-w-xl">
              {story}
            </p>

          </div>

        </div>
      )}

      {cards.founder && (
        <div class="md:col-span-4 p-8 rounded-[var(--radius)] bg-[var(--bg-card)] border border-[var(--border)] flex flex-col justify-start">

          <div class="text-[10px] uppercase tracking-[0.3em] text-[var(--accent)] font-bold mb-3">
            Philosophy
          </div>

          <p class="text-[var(--text-primary)] text-sm leading-relaxed font-medium">
            {founderNote}
          </p>

        </div>
      )}

      {cards.experience && (
        <div class="md:col-span-4 p-8 rounded-[var(--radius)] bg-[var(--text-primary)] text-[var(--bg-color)] border border-[var(--border)]">

          <div class="text-[10px] uppercase tracking-[0.3em] opacity-70 mb-3">
            Experience
          </div>

          <div class="text-3xl md:text-4xl font-black tracking-tight">
            {years}
          </div>

          {industry && (
            <div class="text-xs opacity-60 mt-2 uppercase tracking-wide">
              {industry}
            </div>
          )}

        </div>
      )}

      {cards.differentiator && (
        <div class="md:col-span-4 p-8 rounded-[var(--radius)] bg-[var(--bg-card)] border border-[var(--border)]">

          <div class="text-[10px] uppercase tracking-[0.3em] text-[var(--accent)] font-bold mb-3">
            Differentiator
          </div>

          <p class="text-sm text-[var(--text-secondary)] leading-relaxed">
            {differentiator}
          </p>

        </div>
      )}

    </div>

  </div>

</section>