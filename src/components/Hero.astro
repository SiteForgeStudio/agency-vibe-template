---
import { Image } from 'astro:assets';

const { brand, hero, id } = Astro.props;

/**
 * FACTORY-SAFE IMAGE RESOLUTION
 */
const allImages = import.meta.glob(
  '/src/assets/generated/*/*.{jpg,jpeg,png,webp}',
  { eager: true }
);

const heroFileName = `${brand?.slug || id}-hero`;

const match = Object.entries(allImages).find(([path]) =>
  path.includes(`/generated/${id}/`) &&
  path.includes(heroFileName)
);

const heroImage = match?.[1]?.default;
---

<section id="home" class="relative w-full min-h-[90vh] flex items-center justify-center overflow-hidden">

  {/* BACKGROUND IMAGE */}
  {heroImage && (
    <Image
      src={heroImage}
      alt={brand?.name || "Hero Image"}
      width={1920}
      height={1080}
      class="absolute inset-0 w-full h-full object-cover z-0"
      loading="eager"
    />
  )}

  {/* DARK OVERLAY */}
  <div class="absolute inset-0 bg-black/50 z-10"></div>

  {/* CONTENT */}
  <div class="relative z-20 max-w-5xl mx-auto text-center px-6">

    <h1 class="text-5xl md:text-7xl font-black uppercase tracking-tight text-white leading-tight mb-6">
      {hero?.headline || brand?.name}
    </h1>

    {hero?.subtext && (
      <p class="text-lg md:text-xl text-white/90 mb-8 max-w-2xl mx-auto">
        {hero.subtext}
      </p>
    )}

    {(hero?.cta || hero?.cta_text || brand?.cta_text) && (
      <a
        href="#contact"
        class="inline-block px-10 py-4 bg-[var(--accent)] text-black font-bold uppercase tracking-wider hover:scale-105 transition-transform duration-300"
      >
        {hero?.cta || hero?.cta_text || brand?.cta_text || "Contact Us"}
      </a>
    )}

  </div>

</section>